---
const { images, numColumns } = Astro.props;

let colHeights = Array(numColumns).fill(0);
let columns = Array.from(Array(numColumns), () => new Array());  // 2d array
for (let image of images) {
    let smallestHeight = Math.min(...colHeights);
    let smallestCol = colHeights.indexOf(smallestHeight);
    columns[smallestCol].push(image);
    colHeights[smallestCol] += image.height / image.width;
}
---
<style>
.imageGridContainer {
    display: flex;             /* place columns side by side */
    gap: 8px;                 /* horizontal gap between columns */
}

.column {
    flex: 1;                   /* equal column width */
    display: flex;
    flex-direction: column;    /* stack images vertically */
    gap: 8px;                 /* vertical gap between images */
}

.column img {
    width: 100%;               /* fill column width */
    height: auto;              /* preserve aspect ratio */
    display: block;            /* remove inline whitespace */
    border-radius: 0.2em;
}
</style>
<div class="imageGridContainer">
    {
        [...Array(numColumns).keys()].map((colNum) => 
            <div class="column" >
                {
                    columns[colNum].map((image: any) =>
                        <img src={image.path} title={image.title} />
                    )
                }
            </div>
        )
    }
</div>
